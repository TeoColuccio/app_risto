<!doctype html>

<html>

<head> 
</head>

<body>
    <h1>Categorie</h1>
    
<p><a href="/">Home</a></p>
    
    <div id="categorie"></div>

    ID: <input id="id-nuova-categoria" type="text">
    Categoria: <input id="nuova_categoria" type="text">
    <button id="btn-nuova-categoria">Aggiungi categoria</button>

  <script src="/socket.io/socket.io.js"></script>

  <script>
  var socket = io.connect('http://localhost:3000');

  document.addEventListener('DOMContentLoaded', function () {
    socket.emit('req_categorie');

    var btn = document.getElementById('btn-nuova-categoria');
    btn.addEventListener('click', function () {
      var nuova_categoria = document.getElementById('nuova_categoria');
      var id_nuova_categoria = document.getElementById('id-nuova-categoria');
      
      var ul = document.getElementById('categorie');
      var li = document.createElement('li');
      li.textContent = nuova_categoria.value;
      ul.appendChild(li);

      socket.emit('nuova-categoria', {
          _id: parseInt(id_nuova_categoria.value),
          categoria: nuova_categoria.value
      });
    }, false);

    socket.on('lista_categorie', function (data) {
      console.log(data);
      var ul = document.getElementById('categorie');
      for (var i = 0; i < data.length; i++) {
        var li = document.createElement('li');
        li.textContent = data[i].categoria;
        ul.appendChild(li);
      }
    });
  }, false);

  </script>
</body>

</html>
